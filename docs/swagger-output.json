{
  "openapi": "3.0.0",
  "info": {
    "title": "Shared Music API",
    "version": "1.0.0",
    "description": "API to share music with friends using Spotify."
  },
  "paths": {
    "/login": {
      "get": {
        "summary": "LOGIN with Spotify, using OAuth 2.0 protocol.",
        "description": "Redirects the user to the Spotify login page for authentication.",
        "tags": [
          "Authentication"
        ],
        "responses": {
          "302": {
            "description": "Redirect to Spotify authentication page."
          }
        }
      }
    },
    "/callback": {
      "get": {
        "summary": "Manage the redirection after Spotify authentication.",
        "description": "Handles the callback from Spotify OAuth flow, exchanges code for access token.",
        "tags": [
          "Authentication"
        ],
        "parameters": [
          {
            "in": "query",
            "name": "code",
            "required": true,
            "description": "The authorization code returned by Spotify.",
            "schema": {
              "type": "string"
            }
          },
          {
            "in": "query",
            "name": "state",
            "required": false,
            "description": "The state parameter sent by the client to avoid CSRF.",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved the access token.",
            "content": {
              "text/plain": {
                "schema": {
                  "type": "string",
                  "example": "Access Token: your_access_token_here"
                }
              }
            }
          },
          "500": {
            "description": "Error while getting the Spotify token."
          }
        }
      }
    },
    "/getUserPersonality": {
      "get": {
        "summary": "Get user's music listening personality.",
        "description": "Analyzes the user's top listened tracks to deduce their musical personality based on various audio features.",
        "tags": [
          "User"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Returns the user's music listening personality.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "dance": {
                      "type": "integer",
                      "minimum": 0,
                      "maximum": 10,
                      "description": "Danceability score on a scale of 1 to 10."
                    },
                    "agitation": {
                      "type": "integer",
                      "description": "Average tempo of top tracks."
                    },
                    "preference": {
                      "type": "string",
                      "description": "User's preference for instrumental or vocal tracks."
                    },
                    "attitude": {
                      "type": "string",
                      "description": "User's overall positivity or negativity in music choice."
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "No liked songs, personality impossible to define."
          },
          "500": {
            "description": "Error while getting the Spotify songs or audio statistics."
          }
        }
      }
    },
    "/syncCurrentTrack": {
      "post": {
        "summary": "Synchronise le morceau actuellement joué avec tous les membres du groupe de l'utilisateur.",
        "description": "Récupère le morceau actuellement joué par l'utilisateur ainsi que sa progression, puis synchronise ce morceau avec tous les membres du groupe auquel appartient l'utilisateur. Nécessite que l'utilisateur soit authentifié et membre d'un groupe.",
        "tags": [
          "Groups",
          "Music"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "spotifyToken": {
                    "type": "string",
                    "description": "Token Spotify de l'utilisateur pour accéder à ses informations de lecture en cours."
                  },
                  "username": {
                    "type": "string",
                    "description": "Nom d'utilisateur permettant d'identifier le membre et son groupe."
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Retourne le résultat des appels API pour la synchronisation des morceaux chez les membres du groupe.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "status": {
                        "type": "string",
                        "description": "Statut de la réponse de l'API Spotify pour chaque membre du groupe."
                      },
                      "message": {
                        "type": "string",
                        "description": "Message détaillant le résultat de l'opération de synchronisation pour chaque membre."
                      }
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Le user n'appartient à aucun groupe.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "description": "Description de l'erreur."
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Erreur lors de la synchronisation du morceau actuel avec les membres du groupe.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "description": "Description de l'erreur interne."
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/createPlaylistFromUserTopTracks": {
      "post": {
        "summary": "Crée une playlist à partir des morceaux les plus écoutés d'un autre utilisateur.",
        "description": "Récupère les 10 morceaux les plus écoutés d'un utilisateur spécifié et crée une nouvelle playlist dans le compte Spotify de l'utilisateur actuel contenant ces morceaux.",
        "tags": [
          "Playlists",
          "Music"
        ],
        "parameters": [
          {
            "in": "query",
            "name": "username",
            "required": true,
            "description": "Nom d'utilisateur du compte Spotify dont les top morceaux seront utilisés pour créer la playlist.",
            "schema": {
              "type": "string"
            }
          }
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Tracks added successfully to the playlist!",
            "content": {
              "application/json": {
                "schema": {
                  "type": "string"
                }
              }
            }
          },
          "400": {
            "description": "User or spotify token not found.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "description": "Description de l'erreur."
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Error while getting the user's top tracks or creating a playlist from them.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "description": "Description de l'erreur interne."
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  },
  "components": {},
  "tags": []
}